rules:
- id: aes_hardcoded_key
  languages: 
  - java
  severity: ERROR
  metadata:
    category: security
    references: |
      - https://owasp.org/www-project-mobile-top-10/2014-risks/m2-insecure-data-storage
    Author: Nghia
  message: |
     Hardcoded encryption key makes AES symmetric encryption useless.
  patterns:
    - pattern-either:
        - pattern: |
            $S = new SecretKeySpec("...".getBytes(), "AES");
            ...
            $C.init(..., $S); 
        - pattern: |
            $P = "...";
            ...
            $S = new SecretKeySpec($P.getBytes(), "AES");
            ...
            $C.init(..., $S);
